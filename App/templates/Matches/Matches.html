{% extends "Base.html" %}
{% import "bootstrap/wtf.html" as wtf %}
{% block content %}
<style>.container {
  padding: 2rem 0rem;
}

h4 {
  margin: 2rem 0rem 1rem;
}

.table-image {
  td, th {
    vertical-align: middle;
  }
}</style>
<div class="modal-dialog modal-dialog-centered">
  <div class="modal" tabindex="-1" id="Add">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Match Add</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          {{wtf.quick_form(form, id='AddMatch', action=url_for('MatchesBP.matchsubmit'))}}
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" onclick="document.getElementById('AddMatch').submit()">Add match</button>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="container">
  <div>
    <a type="button" class="btn btn-secondary btn-lg btn-block" id="AddButton" data-bs-toggle="modal" data-bs-target="#Add"><img src="../static/img/plus.svg"></a>
    <!---  --->
    <div class="dropdown">
      <a type="button" class="btn btn-secondary btn-lg btn-block dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"><img src="../static/img/sort.svg"></a>
      <ul class="dropdown-menu" >
        <li><a class="dropdown-item" href={{url_for('MatchesBP.match')}}?time=hour>Last 10 hours</a></li>
        <li><a class="dropdown-item" href={{url_for('MatchesBP.match')}}?time=week>Last week</a></li>
        <li><a class="dropdown-item" href={{url_for('MatchesBP.match')}}?time=month>last month</a></li>
        <li><a class="dropdown-item" href={{url_for('MatchesBP.match')}}?time=all>All</a></li>
      </ul> 
    </div>
  </div>
    <div class="row">
            <div class="d-grid gap-2">
               <button type="button" id="Save" style="display: none;" class="btn btn-success" onclick="SavePOST()">Save<i class="far fa-trash-alt"></i></button>
            </div>
    </div>
  <div class="row">
    <div class="col-12">
      <table class="table table-bordered">
        <thead>
          <tr>
            {% for header in headings%}
            <th scope="col">{{ header }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
            {% for match in data%}
                <tr>
                    <td>
                        {% for team in teams%}
                            {%if team.id == match.team1%}
                            {{team.name}} | {{team.description}}
                            {%endif%}
                        {% endfor %} 
                    </td>
                    <td>
                        {% for team in teams%}
                            {%if team.id == match.team2%}
                            {{team.name}} | {{team.description}}
                            {%endif%}    
                        {% endfor %} 
                    </td>
                    <td>
                        {{match.time}}
                    </td>
                    <td>
                        {{match.format}}
                    </td>
                    <td>
                      {% for team in teams%}
                        {%if team.id == match.winner%}
                          {{team.abbreviation}}
                        {%endif%}    
                      {% endfor %}
                    </td>
                    <td>
                      {% for team in teams%}
                        {%if team.id == match.loser%}
                          {{team.abbreviation}}
                        {%endif%}    
                      {% endfor %}
                    </td>
                    <td>
                      {{match.tournamentcode}}
                    </td>
                    <td>
                      {% if match.decided == 0 %}
                        <button type="button" class="btn btn-primary" onclick="Decide('{{match.id}}')">Pick Winner<i class="far fa-trash-alt"></i></button>
                        <form id="Decide{{match.id}}" action="{{ url_for('MatchesBP.matchdecide') }}" method="post">
                          <input type="hidden" id="id" name="id" value="{{match.id}}">
                        </form>
                      {% endif %}
                      <button type="button" class="btn btn-warning" onclick="Stats('{{match.id}}')">Get Stats<i class="fas fa-edit"></i></button>
                      <form id="Stats{{match.id}}" action="{{ url_for('MatchesBP.matchgetstats') }}" method="post">
                          <input type="hidden" id="id" name="id" value="{{match.id}}">
                      </form>
                      <button type="button" class="btn btn-info" onclick="matchStats('{{match.matchstats}}')">Show Stats<i class="fas fa-edit"></i></button>
                      <form id="matchStats{{match.matchstats}}" action="{{ url_for('RiotAPIBP.MatchStats') }}" method="post">
                          <input type="hidden" id="id" name="id" value="{{match.matchstats}}">
                      </form>
                      <button type="button" class="btn btn-success" id="EditButton" onclick="Edit('{{match.id}}')">Edit<i class="fas fa-edit"></i></button>
                      <form id="Edit{{match.id}}" action="{{ url_for('MatchesBP.matchsave') }}" method="post">
                          <input type="hidden" id="id" name="id" value="{{match.id}}">
                      </form>
                      <button type="button" class="btn btn-danger" onclick="Del('{{match.id}}')">Delete<i class="far fa-trash-alt"></i></button>
                      <form id="Del{{match.id}}" action="{{ url_for('MatchesBP.matchdel') }}" method="post">
                          <input type="hidden" id="id" name="id" value="{{match.id}}">
                      </form>
                    </td>
                </tr>    
            {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
<script>
    let Teams = []
    function Del(id){
        document.getElementById('Del'+id).submit()
    }
    function Edit(id){
        document.getElementById('Edit'+id).submit() 
    }
    function Decide(id){
      document.getElementById('Decide'+id).submit() 
    }
    function Stats(id){
      document.getElementById('Stats'+id).submit() 
    }
    function matchStats(id){
      document.getElementById('matchStats'+id).submit() 
    }
    
  </script>
{% endblock %}